# Phase 9-4: アフィリエイトシステム

## 目的

アフィリエイトプログラム、紹介報酬、パートナー管理を実装し、ユーザー獲得を加速する。

## 実装内容

### 1. アフィリエイトプログラム
- アフィリエイト登録
- 紹介リンク生成
- トラッキングシステム
- コンバージョン計測

### 2. 報酬システム
- 報酬プラン（定額/パーセント/段階制）
- 自動報酬計算
- 支払い管理
- 報酬履歴

**実装メモ**

- `commission_rules` に JSON ベースの `configuration` を追加し、段階制報酬を柔軟に表現
- `AffiliateService.get_commission_report()` で期間指定の集計を提供
- `POST /api/affiliate/payouts/settle` により残高閾値を超えたパートナーを自動的に支払いリクエスト化
- `scripts/generate_affiliate_commission_report.py` で定期レポートを `AnalyticsService` に保存可能

### 3. パートナー管理
- パートナーダッシュボード
- パフォーマンス分析
- ランク・ティアシステム
- 専用クーポン発行

### 4. トラッキング
- クリック追跡
- コンバージョン追跡
- アトリビューション
- 不正検出

### 5. レポート
- 紹介数レポート
- 売上レポート
- コンバージョン率
- トップパートナー

## 期待される効果

- ユーザー獲得コスト: 30%削減
- 新規登録: 100%増加
- パートナー収益: 月平均¥50,000
- バイラル係数: 1.5以上
