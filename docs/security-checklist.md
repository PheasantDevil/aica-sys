# セキュリティチェックリスト

Phase 8-5: セキュリティ強化と運用

## デプロイ前チェックリスト

### コード

- [ ] 機密情報（APIキー、パスワード）がコードに含まれていない
- [ ] 環境変数を使用している
- [ ] SQLインジェクション対策済み
- [ ] XSS対策済み
- [ ] CSRF対策済み
- [ ] 入力検証を実装
- [ ] 出力エスケープを実装

### 依存関係

- [ ] Python依存関係にCritical脆弱性なし（`safety check`）
- [ ] npm依存関係にCritical脆弱性なし（`npm audit`）
- [ ] 未使用の依存関係を削除
- [ ] 依存関係のバージョン固定

### 認証・認可

- [ ] 適切な認証機構を実装
- [ ] パスワードのハッシュ化
- [ ] セッション管理が適切
- [ ] トークンの有効期限設定
- [ ] 権限チェックを実装

### API

- [ ] レート制限を実装
- [ ] CORS設定が適切
- [ ] APIキーの検証
- [ ] リクエストサイズ制限
- [ ] タイムアウト設定

### インフラ

- [ ] HTTPS/TLS設定
- [ ] セキュリティヘッダー設定
- [ ] ファイアウォール設定
- [ ] 非rootユーザーで実行
- [ ] 最小権限の原則

## デプロイ後チェックリスト

### 即座に確認

- [ ] ヘルスチェックエンドポイント正常
- [ ] SSL証明書有効
- [ ] セキュリティヘッダー設定確認
- [ ] エラーログなし
- [ ] 認証機能正常

### 24時間以内に確認

- [ ] アプリケーションログレビュー
- [ ] セキュリティアラートなし
- [ ] パフォーマンス正常
- [ ] バックアップ成功
- [ ] 監視システム正常動作

## 定期セキュリティチェック

### 週次

- [ ] セキュリティスキャン実行
- [ ] 依存関係更新確認
- [ ] セキュリティアラート確認
- [ ] アクセスログレビュー

```bash
make security-check
gh pr list --label dependencies
```

### 月次

- [ ] 包括的セキュリティ監査
- [ ] ユーザーアクセス権限レビュー
- [ ] SSL証明書有効期限確認
- [ ] セキュリティパッチ適用

```bash
./scripts/security-check.sh
# SSL証明書確認
openssl s_client -connect api.aica-sys.com:443 -servername api.aica-sys.com | openssl x509 -noout -dates
```

### 四半期

- [ ] ペネトレーションテスト
- [ ] セキュリティポリシーレビュー
- [ ] インシデント対応訓練
- [ ] 第三者セキュリティ監査

## セキュリティインシデント対応

### 検出

```bash
# 不審なアクティビティ検出
grep -i "failed\|error\|unauthorized" logs/

# アラート確認
curl http://localhost:9093  # Alertmanager
```

### 対応

1. **隔離**: 影響を受けたシステムを隔離
2. **調査**: ログ分析、攻撃パターン特定
3. **対策**: 脆弱性の修正、パッチ適用
4. **復旧**: システムの復旧
5. **報告**: インシデントレポート作成

### 連絡先

- **セキュリティ担当**: security@aica-sys.com
- **インシデント報告**: incident@aica-sys.com

## セキュリティベストプラクティス

### シークレット管理

- 環境変数を使用
- GitHub Secretsで管理
- 定期的なローテーション
- アクセス権限の最小化

### アクセス制御

- 最小権限の原則
- MFA（多要素認証）の有効化
- アクセスログの監視
- 定期的な権限レビュー

### データ保護

- 転送時の暗号化（HTTPS/TLS）
- 保存時の暗号化
- 個人情報の適切な管理
- データバックアップ

## セキュリティツール

### インストール済み

- **Safety**: Python依存関係スキャン
- **Bandit**: Pythonコードセキュリティ
- **npm audit**: npm依存関係スキャン
- **TruffleHog**: シークレット検出
- **Trivy**: Dockerイメージスキャン

### 使用方法

```bash
# 全セキュリティチェック実行
make security-check

# 個別実行
cd backend && safety check
cd frontend && npm audit
bandit -r backend/
```

## コンプライアンス

### GDPR対応

- [ ] ユーザーデータの同意取得
- [ ] データポータビリティ
- [ ] 削除権の実装
- [ ] プライバシーポリシー

### セキュリティスタンダード

- [ ] OWASP Top 10 対策
- [ ] CWE/SANS Top 25 対策
- [ ] セキュアコーディング実践

## 参考資料

- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [CWE Top 25](https://cwe.mitre.org/top25/)
- [Security Best Practices](https://cheatsheetseries.owasp.org/)
